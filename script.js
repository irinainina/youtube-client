const body=document.querySelector("body");function init(){const e=document.createElement("div");e.classList.add("search");const t=document.createElement("input");t.autofocus=!0,t.placeholder="Awesome Javascript",e.appendChild(t);const n=document.createElement("button");e.appendChild(n),body.appendChild(e);const a=document.createElement("div");a.classList.add("container");const i=document.createElement("div");i.classList.add("items"),a.appendChild(i),body.appendChild(a);const o=document.createElement("ul");o.classList.add("pagination"),body.appendChild(o)}init();const input=document.querySelector("input"),button=document.querySelector("button"),container=document.querySelector(".container"),items=document.querySelector(".items"),pagination=document.querySelector(".pagination");let randomColor;function colorChange(){const e=document.createElement("div");e.classList.add("colorpicker"),pagination.appendChild(e),e.addEventListener("click",function(){const e=Math.floor(360*Math.random()),t=Math.floor(25*Math.random()+75),n=Math.floor(20*Math.random()+20);randomColor=`hsla(${e},${t}%,${n}%, 1)`,body.style.backgroundColor=randomColor,document.querySelectorAll(".title").forEach(e=>{e&&(e.style.backgroundColor=randomColor)})})}colorChange();let nextPageToken,myAPIKey="AIzaSyCTWC75i70moJLzyNh3tt4jzCljZcRkU8Y";function getVideoData(){const e=`${nextPageToken?`pageToken=${nextPageToken}`:""}&key=${myAPIKey}&type=video&part=snippet&maxResults=15&q=${input.value}`;fetch("https://www.googleapis.com/youtube/v3/search?"+e).then(e=>e.json()).then(e=>{nextPageToken=e.nextPageToken;const t=e.items.map(e=>e.id.videoId).join(",");return fetch(`https://www.googleapis.com/youtube/v3/videos?key=${myAPIKey}&id=${t}&part=snippet,statistics`)}).then(e=>e.json()).then(e=>{render(e.items.map(e=>({id:e.id,title:e.snippet.title,author:e.snippet.channelTitle,views:e.statistics.viewCount,published:e.snippet.publishedAt,pictureUrl:e.snippet.thumbnails.medium.url,description:e.snippet.description})))})}function newVideoData(){items.scrollWidth-items.scrollLeft<3*container.offsetWidth&&getVideoData()}function render(e){input.value&&e.forEach(e=>{const t=document.createElement("div");t.classList.add("item");const n=document.createElement("div");n.classList.add("picture");const a=document.createElement("h3");a.classList.add("title"),a.style.backgroundColor=randomColor||"#1b2735";const i=document.createElement("a");a.appendChild(i),n.appendChild(a),t.appendChild(n);const o=document.createElement("p");o.classList.add("author"),t.appendChild(o);const s=document.createElement("p");s.classList.add("views"),t.appendChild(s);const d=document.createElement("p");d.classList.add("published"),t.appendChild(d);const c=document.createElement("p");c.classList.add("description"),t.appendChild(c),n.style.backgroundImage=`url(${e.pictureUrl})`,i.innerText=e.title,i.href=`https://www.youtube.com/watch?v=${e.id}`,i.target="_blank",o.innerText=e.author,s.innerText=e.views.replace(/\B(?=(?:\d{3})+(?!\d))/g," "),d.innerText=e.published.split("T")[0],c.innerText=e.description,items.appendChild(t)})}function widthContainer(){window.matchMedia("(min-width: 1440px)").matches?(maxNumPage=24,container.style.width="1440px"):window.matchMedia("(min-width: 1080px) and (max-width: 1439px)").matches?(maxNumPage=32,container.style.width="1080px"):window.matchMedia("(min-width: 720px) and (max-width: 1079px)").matches?(maxNumPage=48,container.style.width="720px"):window.matchMedia("(min-width: 360px) and (max-width: 719px)").matches?(maxNumPage=96,container.style.width="360px"):window.matchMedia("(min-width: 320px) and (max-width: 359px)").matches&&(maxNumPage=96,container.style.width="320px")}button.addEventListener("click",e=>{input.onchange=(()=>{items.innerHTML="",nextPageToken=!1,currentNumPage()}),getVideoData(),createPagination()}),input.addEventListener("keydown",e=>{"Enter"===e.key&&(input.onchange=(()=>{items.innerHTML="",nextPageToken=!1,currentNumPage()}),getVideoData(),createPagination())});let startX,x,maxNumPage=24,numPage=1,isDown=!1;function desktopSlider(){items.addEventListener("mousedown",e=>{isDown=!0,startX=e.pageX}),items.addEventListener("mouseleave",()=>{isDown=!1}),items.addEventListener("mouseup",()=>{x=event.pageX,newVideoData()}),items.addEventListener("click",e=>{if(!isDown)return;const t=x-startX;t>0&&numPage>1?(items.scrollBy(-container.offsetWidth,0),items.scrollLeft=container.offsetWidth*(numPage-2),numPage--,currentNumPage()):t<0&&numPage<maxNumPage&&(items.scrollBy(container.offsetWidth,0),items.scrollLeft=container.offsetWidth*numPage,numPage++,currentNumPage(),newVideoData())})}function mobileSlider(){document.addEventListener("touchstart",function(e){const t=function(e){return e.touches}(e)[0];isDown=t.clientX},!1),document.addEventListener("touchmove",function(e){if(!isDown)return;const t=(x=e.touches[0].clientX)-isDown;t>0&&numPage>1?(items.scrollBy(-container.offsetWidth,0),items.scrollLeft=container.offsetWidth*(numPage-2),numPage--,currentNumPage()):t<0&&numPage<maxNumPage&&(items.scrollBy(container.offsetWidth,0),items.scrollLeft=container.offsetWidth*numPage,numPage++,currentNumPage(),newVideoData()),isDown=!1},!1)}function selectionDevice(){/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&mobileSlider()}desktopSlider(),selectionDevice(),window.addEventListener("resize",()=>{selectionDevice(),widthContainer(),numPage=Math.round(items.scrollLeft/container.offsetWidth)+1,currentNumPage()});let isPagination=!1;function createPagination(){if(!isPagination&&input.value){for(let e=0;e<4;e++){const t=document.createElement("li");t.classList.add("page");const n=document.createElement("span");n.classList.add("tooltip"),t.appendChild(n),0===e?t.classList.add("prevprevpage"):1===e?t.classList.add("prevpage"):2===e?t.classList.add("pageactive"):3===e&&t.classList.add("nextpage"),pagination.appendChild(t)}isPagination=!0}}function currentNumPage(){const e=pagination.querySelectorAll(".page"),t=pagination.querySelectorAll(".tooltip");if(!input.value||numPage<1)return;pagination.querySelector(".pageactive").innerText=numPage||1,t.forEach((e,t)=>{1===numPage?e.innerText=numPage+1:2===numPage&&1===t?e.innerText=numPage-1:2===numPage&&2===t?e.innerText=numPage+1:numPage>2&&0===t?e.innerText=numPage-2:numPage>2&&1===t?e.innerText=numPage-1:numPage>2&&2===t&&(e.innerText=numPage+1)}),e.forEach((e,t)=>{1===numPage&&0===t?e.classList.add("pagedisable"):1===numPage&&1===t?e.classList.add("pagedisable"):2===numPage&&0===t?e.classList.add("pagedisable"):numPage===maxNumPage&&3===t?e.classList.add("pagedisable"):e.classList.remove("pagedisable")})}pagination.addEventListener("click",e=>{e.target.classList.contains("prevprevpage")?(items.scrollBy(2*-container.offsetWidth,0),numPage-=2,items.scrollLeft=container.offsetWidth*(numPage-1),currentNumPage()):e.target.classList.contains("prevpage")?(items.scrollBy(-container.offsetWidth,0),numPage--,items.scrollLeft=container.offsetWidth*(numPage-1),currentNumPage()):e.target.classList.contains("nextpage")&&numPage<maxNumPage&&(items.scrollBy(container.offsetWidth,0),numPage++,items.scrollLeft=container.offsetWidth*(numPage-1),currentNumPage()),newVideoData()});